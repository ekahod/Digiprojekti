<!DOCTYPE html>
<html lang="fi">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <title>Kysely</title>
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="styles.css" rel="stylesheet" />
    <link
      href="https://fonts.googleapis.com/css2?family=Muli:ital,wght@0,500;0,700;1,500&display=swap"
      rel="stylesheet"
    />
    <script
      src="https://kit.fontawesome.com/7b86f724f2.js"
      crossorigin="anonymous"
    ></script>
  </head>

  <body>
    <div class="form-wrapper">
      <form id="lomake" name="kysely"></form>
    </div>
    <!-- Jquery -->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>

    <script>
      var lomakekentta = [];

      $.getJSON("kysymykset.json", function (data) {
        var items = [];

        items.push("<h1> " + data.otsikko + "</h1>");
        items.push("<p> " + data.prologi + "</p>");

        var kysymykset = data.kysymykset;
        items.push('<div class="kysymykset">');
        $.each(kysymykset, function (key, d) {
          lomakekentta.push(d.id);

          if (d.tyyppi === "text") {
            items.push(
              '<div class="kysymys-wrapper"> <label><h2>' +
                d.kysymys +
                "</h2></label>"
            );
            items.push(
              '<input id="' + d.id + '" class="text-input" type="text"/></div>'
            );
          } else if (d.tyyppi === "radio" || d.tyyppi === "checkbox") {
            var value = d.value;
            items.push(
              '<div class="kysymys-wrapper multi-wrapper"> <h2>' +
                d.kysymys +
                "</h2>"
            );

            $.each(value, function (i, v) {
              items.push(
                '<div class="items-wrapper"> <input type="' +
                  d.tyyppi +
                  '" name="' +
                  d.id +
                  '" id="' +
                  v.valueId +
                  '" value="' +
                  v.option +
                  '"/>'
              );
              items.push(
                '<label class="option-label" for="' +
                  v.valueId +
                  '">' +
                  v.option +
                  "</label> </div>"
              );
            });

            items.push("</div>");
          }
        });
        items.push("</div>");
        items.push(
          '<div class="btn-wrapper"> <button class="laheta-btn">Lähetä</button> </div>'
        );
        $("#lomake").append(items.join(""));
      });

      function send() {
        //muuttuja, jota käytetään for elementin looppaamiseen eli form tagin sisällä olevien elementtien määrä
        var formLength = document.kysely.elements.length;
        var formValues = [];

        for (i = 0; i < formLength; i++) {
          var tyyppi = kysely.elements[i].type;
          var inputId = kysely.elements[i].id;
          var inputName = kysely.elements[i].name;
          var selectedRadio;
          var selectedCheckboxes = [];

          if (tyyppi === "text") {
            var textInputValue = document.getElementById(inputId).value;
            formValues.push("kysymys: " + inputId + ", vastaus: " + textInputValue + ",")
          } else if (tyyppi === "radio") {
            var radios = document.getElementsByName(inputName);
            for (var x = 0, length = radios.length; x < length; x++) {
              if (radios[x].checked) {
                selectedRadio = radios[x].value;
                formValues.push("kysymys: " + inputName + ", vastaus: " + selectedRadio + "," )
              }
            }
          } else if (tyyppi === "checkbox") {
            var checkboxes = document.getElementsByName(inputName);
            for (var y = 0, length = checkboxes.length; y < length; y++) {
              if (checkboxes[y].checked) {
                selectedCheckboxes.push(checkboxes[y].value);
              }
            }
          }
        }
        console.log(formValues);
      }
    </script>
  </body>
</html>
